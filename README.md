# Overt - Android设备安全检测工具

## 项目概述

Overt是一个Android设备安全检测工具，通过收集和分析各种系统信息来检测设备是否被Root、被调试工具注入或存在其他安全风险。

## 主要功能

### 1. 设备信息收集模块

#### 核心模块
- **zDevice**: 设备信息管理器，采用单例模式，负责管理和存储各种设备信息
- **native-lib**: 主要的JNI库，包含设备信息收集线程和JNI接口

#### 信息收集模块
- **local_network_info**: 本地网络信息检测，通过UDP广播检测同一网络中的其他Overt设备
- **task_info**: 任务信息检测，分析进程线程状态，检测Frida等调试工具注入
- **maps_info**: 内存映射信息检测，分析关键系统库的映射情况，检测是否被篡改
- **root_file_info**: Root文件检测，检查常见的Root相关文件（如su、mu等）
- **mounts_info**: 挂载点信息检测，检测异常的挂载点（如dex2oat、APatch等）
- **system_prop_info**: 系统属性检测，检查关键系统属性的值是否正确
- **linker_info**: 链接器信息检测，分析动态链接库加载情况
- **port_info**: 端口信息检测，检查网络端口异常
- **class_loader_info**: 类加载器信息检测，检测Java层异常
- **package_info**: 包信息检测，检查已安装应用异常
- **system_setting_info**: 系统设置信息检测，检测系统设置异常
- **tee_info**: TEE信息检测，检测可信执行环境异常
- **ssl_info**: SSL信息检测，检测SSL证书异常
- **time_info**: 时间信息检测，检测系统时间异常

### 2. 工具类模块

#### 文件操作
- **zFile**: 文件操作工具类，提供文件读取、目录遍历、文件属性查询等功能

#### 工具函数
- **zUtil**: 通用工具类，提供字符串处理、JNI转换、线程优化等功能

## 技术特点

### 1. 多维度检测
- 系统文件检测：检查Root相关文件
- 进程检测：分析线程状态，检测调试工具注入
- 内存检测：分析库映射情况，检测篡改
- 网络检测：检测同一网络中的威胁设备
- 属性检测：检查系统属性异常

### 2. 性能优化
- 线程绑定：将检测线程绑定到大核心CPU
- 优先级提升：提高检测线程优先级
- 异步处理：后台线程持续收集信息

### 3. 线程安全
- 读写锁：使用shared_mutex保证数据一致性
- 单例模式：确保设备信息管理器的唯一性

## 检测逻辑

### 1. Root检测
- 检查常见Root文件（su、mu等）
- 检查系统属性（ro.secure、ro.debuggable等）
- 检查挂载点异常

### 2. 调试工具检测
- 检测Frida注入的线程（gmain、pool-frida）
- 检查关键库的映射数量和权限
- 分析动态链接库加载情况

### 3. 系统完整性检测
- 检查系统属性值是否正确
- 检查关键库是否被篡改
- 检测系统挂载点异常

## 使用方式

### 1. 编译
```bash
./gradlew assembleDebug
```

### 2. 运行
应用启动后会自动开始设备信息收集，通过JNI接口返回检测结果。

### 3. 结果格式
检测结果采用三层嵌套Map结构：
```
{
  "检测类别": {
    "检测项目": {
      "risk": "风险等级",
      "explain": "说明"
    }
  }
}
```

## 风险等级说明

- **error**: 高风险，明确检测到安全威胁
- **warn**: 中风险，可能存在安全威胁
- **info**: 低风险，仅供参考

## 注意事项

1. 该工具需要系统权限才能进行完整的检测
2. 某些检测可能会被反检测技术绕过
3. 检测结果仅供参考，需要结合其他安全措施

## 开发说明

### 添加新的检测模块
1. 创建对应的.h和.cpp文件
2. 实现get_xxx_info()函数
3. 在native-lib.cpp中添加调用
4. 在zDevice中注册信息

### 代码规范
- 所有函数和类都需要添加详细的中文注释
- 使用统一的日志格式
- 遵循线程安全原则
